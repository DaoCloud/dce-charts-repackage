{{- if and .Values.config.unseal.static.enabled .Values.staticUnsealSecret.generate }}
apiVersion: v1
kind: Secret
metadata:
  {{- $name := printf "%s-static-unseal" (include "openbao.fullname" .) }}
  name: {{ $name }}
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "openbao.labels" . | nindent 4 }}
  annotations:
    "helm.sh/resource-policy": "keep"
data:
  {{- $key := (lookup "v1" "Secret" .Release.Namespace $name) | dig "data" "key" (randBytes 32) }}
  key: {{ $key | quote }}
{{- end }}
